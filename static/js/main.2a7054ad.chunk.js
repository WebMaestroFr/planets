(this.webpackJsonpplanets=this.webpackJsonpplanets||[]).push([[0],{131:function(e,n,t){},143:function(e,n){},176:function(e,n,t){"use strict";t.r(n);var i=t(4),a=t(0),s=t.n(a),o=t(15),c=t.n(o),r=(t(131),t(20)),l=t(10),u=t(72),j=t(62),b=t.n(j),O=t(63),f=t.n(O),g=t(64),d=t.n(g),m=t(2),p=t(5),h=t(17),v=function(e){var n=Object(l.a)(e,2),t=n[0],i=n[1];return[m.MathUtils.radToDeg(i),90-m.MathUtils.radToDeg(t)]},x=function(e){var n=Object(l.a)(e,2),t=n[0],i=n[1];return[m.MathUtils.degToRad(90-i),m.MathUtils.degToRad(t)]},S=function(e){var n=Object(l.a)(e,2),t=n[0],i=n[1];return[Math.PI-Math.acos(2*i-1),2*Math.PI*t-Math.PI]},M=function(e){var n=e.center,t=e.polygon,s=e.settings,o=Object(h.a)(e,["center","polygon","settings"]),c=Object(a.useMemo)((function(){return t.map((function(e){return e.noise}))}),[t]),l=Object(a.useMemo)((function(){return t.map((function(e){return e.position}))}),[t]),u=Object(a.useCallback)((function(e,n){var t=s.radius+Math.max(s.noiseMin,n)*s.elevationScale;return e.setLength(t),t}),[s.elevationScale,s.noiseMin,s.radius]),j=Object(a.useCallback)((function(e){return n.noise*s.elevationOffset+e*(1-s.elevationOffset)}),[n.noise,s.elevationOffset]),b=Object(a.useCallback)((function(e){var t=u(e.center,n.noise);if(n.noise<=s.noiseMin)for(var i=0;i<e.polygon.length;i++)e.polygon[i].setLength(t);else for(var a=0;a<e.polygon.length;a++){var o=j(c[a]);u(e.polygon[a],o)}}),[u,n.noise,j,c,s.noiseMin]),O=Object(a.useCallback)((function(e){e.origin.set(0,0,0),e.center.copy(n.position);for(var t=0;t<e.polygon.length;t++)e.polygon[t].copy(l[t])}),[n.position,l]),f=Object(r.e)((function(e){var n=function(e){return{center:e[e.length-1],origin:e[0],polygon:e.slice(1,e.length-1)}}(e.vertices);O(n),b(n)}),[b,O]);return Object(i.jsx)("coneGeometry",Object(p.a)({args:[1,1,t.length],name:"TileGeometry",ref:f},o))},C=function(e){var n=e.tile,t=e.settings,a=Object(h.a)(e,["tile","settings"]);return Object(i.jsxs)("mesh",Object(p.a)(Object(p.a)({name:"TileMesh"},a),{},{children:[Object(i.jsx)("meshStandardMaterial",{color:n.color}),Object(i.jsx)(M,{center:n.center,polygon:n.polygon,settings:t})]}))},y=function(e){var n=e.settings,t=Object(a.useState)([]),s=Object(l.a)(t,2),o=s[0],c=s[1],r=Object(a.useMemo)((function(){return new b.a({shape:[1,1],minDistance:n.minDistance,tries:n.tries},f()(n.seed))}),[n.minDistance,n.seed,n.tries]),j=Object(a.useMemo)((function(){return new d.a(n.seed)}),[n.seed]),O=Object(a.useCallback)((function(e){var t=e.clone().setLength(n.noiseRadius),i=t.x,a=t.y,s=t.z;return j.noise3D(i,a,s)}),[n.noiseRadius,j]),g=Object(a.useCallback)((function(e){var n=Object(l.a)(e,2),t=n[0],i=n[1],a=new m.Vector3;return a.setFromSphericalCoords(1,t,i),{noise:O(a),position:a}}),[O]);Object(a.useEffect)((function(){var e=r.fill().map(S),t=e.map(v),i=Object(u.a)(t),a=i.centers.map(x).map(g),s=i.polygons.map((function(t,i){var s,o=g(e[i]);return{center:o,color:null===(s=n.biomes.find((function(e){return o.noise<=e.noiseMax})))||void 0===s?void 0:s.color,polygon:t.map((function(e){return a[e]}))}}));c(s)}),[r,n.biomes,g]);var p=Date.now().toString();return Object(i.jsx)("group",{name:"Planet",children:o.map((function(e,t){return Object(i.jsx)(C,{settings:n,tile:e},"".concat(p,"-").concat(t))}))})},D=t(68),N=Object(a.createContext)(null);Object(r.b)({OrbitControls:D.a});var z=function(e){var n=e.children,t=Object(h.a)(e,["children"]),s=Object(a.useRef)(),o=Object(r.d)(),c=o.camera,l=o.gl;return Object(r.c)((function(){s&&s.current&&s.current.update()})),Object(a.useEffect)((function(){c.position.set(0,0,16)}),[c.position]),Object(i.jsxs)(N.Provider,{value:t,children:[Object(i.jsx)("orbitControls",{args:[c,l.domElement],ref:s}),n]})},R={planet:{biomes:[{color:"steelblue",noiseMax:0},{color:"lemonchiffon",noiseMax:1/6},{color:"yellowgreen",noiseMax:2/6},{color:"forestgreen",noiseMax:.5},{color:"burlywood",noiseMax:4/6},{color:"darkgrey",noiseMax:5/6},{color:"snow",noiseMax:1}],elevationOffset:.5,elevationScale:1,noiseMin:0,noiseRadius:1,minDistance:.02,position:[0,0,0],radius:8,seed:Date.now().toString(),tries:8}},w=Object(a.createContext)(R),k=function(){return Object(a.useContext)(w)},T=t(7),P=t(180),L=function(e){var n,t=e.children,s=Object(a.useState)(R.planet),o=Object(l.a)(s,2),c=o[0],r=o[1],u=function(e){return function(n){return r((function(t){return Object(p.a)(Object(p.a)({},t),{},Object(T.a)({},e,n))}))}};return Object(i.jsxs)(w.Provider,{value:{planet:c},children:[t,Object(i.jsxs)("form",{className:"Settings",children:[Object(i.jsx)(P.a,{className:"Settings-seed",label:"Seed",children:Object(i.jsx)(P.b,{defaultValue:c.seed,fill:!0,onChange:(n="seed",function(e){var t=e.currentTarget.value;return r((function(e){return Object(p.a)(Object(p.a)({},e),{},Object(T.a)({},n,t))}))})})}),Object(i.jsx)(P.a,{className:"Settings-radius",label:"Radius",children:Object(i.jsx)(P.c,{fill:!0,min:0,onValueChange:u("radius"),value:c.radius})}),Object(i.jsx)(P.a,{className:"Settings-minDistance",label:"Sampling Minimum Distance",children:Object(i.jsx)(P.c,{fill:!0,min:.01,minorStepSize:null,onValueChange:u("minDistance"),stepSize:.01,value:c.minDistance})}),Object(i.jsx)(P.a,{className:"Settings-tries",label:"Sampling tries",children:Object(i.jsx)(P.c,{fill:!0,min:2,minorStepSize:null,onValueChange:u("tries"),value:c.tries})}),Object(i.jsx)(P.a,{className:"Settings-noiseRadius",label:"Noise Radius",children:Object(i.jsx)(P.c,{fill:!0,min:0,minorStepSize:null,onValueChange:u("noiseRadius"),stepSize:.1,value:c.noiseRadius})}),Object(i.jsx)(P.a,{className:"Settings-noiseMin",label:"Minimum Noise",children:Object(i.jsx)(P.d,{labelStepSize:.5,max:1,min:-1,onChange:u("noiseMin"),stepSize:.1,value:c.noiseMin})}),Object(i.jsx)(P.a,{className:"Settings-elevationOffset",label:"Elevation Offset",children:Object(i.jsx)(P.d,{labelStepSize:.25,max:1,min:0,onChange:u("elevationOffset"),stepSize:.01,value:c.elevationOffset})}),Object(i.jsx)(P.a,{className:"Settings-elevationScale",label:"Elevation Scale",children:Object(i.jsx)(P.c,{fill:!0,min:0,minorStepSize:null,onValueChange:u("elevationScale"),value:c.elevationScale})})]})]})},V=function(){var e=k();return Object(i.jsxs)(r.a,{className:"Scene",children:[Object(i.jsx)("ambientLight",{}),Object(i.jsxs)(z,{children:[Object(i.jsx)("pointLight",{position:[16,16,16]}),Object(i.jsx)(y,{settings:e.planet})]})]})},E=function(){return Object(i.jsx)(L,{children:Object(i.jsx)(V,{})})},F=function(e){e&&e instanceof Function&&t.e(3).then(t.bind(null,181)).then((function(n){var t=n.getCLS,i=n.getFID,a=n.getFCP,s=n.getLCP,o=n.getTTFB;t(e),i(e),a(e),s(e),o(e)}))};c.a.render(Object(i.jsx)(s.a.StrictMode,{children:Object(i.jsx)(E,{})}),document.getElementById("root")),F()}},[[176,1,2]]]);
//# sourceMappingURL=main.2a7054ad.chunk.js.map