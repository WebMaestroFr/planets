(this.webpackJsonpplanets=this.webpackJsonpplanets||[]).push([[0],{130:function(e,n,t){},142:function(e,n){},174:function(e,n,t){"use strict";t.r(n);var a=t(4),i=t(0),c=t.n(i),o=t(16),r=t.n(o),s=(t(130),t(20)),l={planet:{biomes:[{color:"steelblue",noiseMax:0},{color:"lemonchiffon",noiseMax:1/6},{color:"yellowgreen",noiseMax:2/6},{color:"forestgreen",noiseMax:.5},{color:"burlywood",noiseMax:4/6},{color:"darkgrey",noiseMax:5/6},{color:"snow",noiseMax:1}],elevationOffset:.5,elevationScale:1,noiseMin:0,noiseRadius:1,minDistance:.04,position:[0,0,0],radius:8,seed:Date.now().toString(),tries:8}},u=Object(i.createContext)(l),j=function(){return Object(i.useContext)(u)},b=t(9),O=t(71),f=t(61),m=t.n(f),d=t(62),p=t.n(d),g=t(63),h=t.n(g),v=t(2),x=function(e){var n=Object(b.a)(e,2),t=n[0],a=n[1];return[v.MathUtils.radToDeg(a),90-v.MathUtils.radToDeg(t)]},S=function(e){var n=Object(b.a)(e,2),t=n[0],a=n[1];return[v.MathUtils.degToRad(90-a),v.MathUtils.degToRad(t)]},M=function(e){var n=Object(b.a)(e,2),t=n[0],a=n[1];return[Math.PI-Math.acos(2*a-1),2*Math.PI*t-Math.PI]};var C=t(5),y=t(17),P=function(e){var n=e.center,t=e.polygon,c=Object(y.a)(e,["center","polygon"]),o=j().planet,r=o.biomes,l=o.elevationOffset,u=o.elevationScale,b=o.noiseMin,O=o.radius,f=Object(i.useMemo)((function(){var e;return null===(e=r.find((function(e){return n.noise<=e.noiseMax})))||void 0===e?void 0:e.color}),[r,n.noise]),m=Object(i.useMemo)((function(){return t.map((function(e){return e.noise}))}),[t]),d=Object(i.useMemo)((function(){return t.map((function(e){return e.position}))}),[t]),p=Object(i.useCallback)((function(e,n){var t=O+Math.max(b,n)*u;return e.setLength(t),t}),[u,b,O]),g=Object(i.useCallback)((function(e){return n.noise*l+e*(1-l)}),[n.noise,l]),h=Object(i.useCallback)((function(e){var t=p(e.center,n.noise);if(n.noise<=b)for(var a=0;a<e.polygon.length;a++)e.polygon[a].setLength(t);else for(var i=0;i<e.polygon.length;i++){var c=g(m[i]);p(e.polygon[i],c)}}),[p,n.noise,g,m,b]),v=Object(i.useCallback)((function(e){e.origin.set(0,0,0),e.center.copy(n.position);for(var t=0;t<e.polygon.length;t++)e.polygon[t].copy(d[t])}),[n.position,d]),x=Object(s.e)((function(e){var n=function(e){return{center:e[e.length-1],origin:e[0],polygon:e.slice(1,e.length-1)}}(e.geometry.vertices);v(n),h(n)}),[h,v]);return Object(a.jsxs)("mesh",Object(C.a)(Object(C.a)({name:"PlanetTile"},c),{},{ref:x,children:[Object(a.jsx)("meshStandardMaterial",{color:f}),Object(a.jsx)("coneGeometry",{args:[1,1,t.length]})]}))},F=function(){var e=function(e){var n=e.minDistance,t=e.noiseRadius,a=e.seed,c=e.tries,o=Object(i.useState)([]),r=Object(b.a)(o,2),s=r[0],l=r[1],u=Object(i.useMemo)((function(){return new m.a({shape:[1,1],minDistance:n,tries:c},p()(a))}),[n,a,c]),j=Object(i.useMemo)((function(){return new h.a(a)}),[a]),f=Object(i.useCallback)((function(e){var n=e.clone().setLength(t),a=n.x,i=n.y,c=n.z;return j.noise3D(a,i,c)}),[t,j]),d=Object(i.useCallback)((function(e){var n=Object(b.a)(e,2),t=n[0],a=n[1],i=new v.Vector3;return i.setFromSphericalCoords(1,t,a),{noise:f(i),position:i}}),[f]);return Object(i.useEffect)((function(){var e=u.fill().map(M),n=e.map(x),t=Object(O.a)(n),a=t.centers.map(S).map(d),i=t.polygons.map((function(n,t){return{center:d(e[t]),polygon:n.map((function(e){return a[e]}))}}));l(i)}),[u,d]),s}(j().planet),n=Date.now().toString();return Object(a.jsx)("group",{name:"Planet",children:e.map((function(e,t){return Object(a.jsx)(P,{center:e.center,polygon:e.polygon},"".concat(n,"-").concat(t))}))})},D=t(67),N=Object(i.createContext)(null);Object(s.b)({OrbitControls:D.a});var z=function(e){var n=e.children,t=Object(y.a)(e,["children"]),c=Object(i.useRef)(),o=Object(s.d)(),r=o.camera,l=o.gl;return Object(s.c)((function(){c&&c.current&&c.current.update()})),Object(i.useEffect)((function(){r.position.set(0,0,16)}),[r.position]),Object(a.jsxs)(N.Provider,{value:t,children:[Object(a.jsx)("orbitControls",{args:[r,l.domElement],ref:c}),n]})},k=t(7),w=t(178),R=function(e){var n=e.onUpdate,t=e.settings,c=t.elevationOffset,o=t.elevationScale,r=t.minDistance,s=t.noiseMin,l=t.noiseRadius,u=t.radius,j=t.seed,b=t.tries,O=Object(i.useCallback)((function(e){return function(t){var a=t.currentTarget.value;return n((function(n){return Object(C.a)(Object(C.a)({},n),{},Object(k.a)({},e,a))}))}}),[n]),f=Object(i.useCallback)((function(e){return function(t){return n((function(n){return Object(C.a)(Object(C.a)({},n),{},Object(k.a)({},e,t))}))}}),[n]);return Object(a.jsxs)("form",{className:"PlanetForm",children:[Object(a.jsx)(w.a,{className:"PlanetForm-seed",label:"Seed",children:Object(a.jsx)(w.b,{defaultValue:j,fill:!0,onChange:O("seed")})}),Object(a.jsx)(w.a,{className:"PlanetForm-radius",label:"Radius",children:Object(a.jsx)(w.c,{fill:!0,min:0,onValueChange:f("radius"),value:u})}),Object(a.jsx)(w.a,{className:"PlanetForm-minDistance",label:"Sampling Minimum Distance",children:Object(a.jsx)(w.c,{fill:!0,min:.01,minorStepSize:null,onValueChange:f("minDistance"),stepSize:.01,value:r})}),Object(a.jsx)(w.a,{className:"PlanetForm-tries",label:"Sampling tries",children:Object(a.jsx)(w.c,{fill:!0,min:2,minorStepSize:null,onValueChange:f("tries"),value:b})}),Object(a.jsx)(w.a,{className:"PlanetForm-noiseRadius",label:"Noise Radius",children:Object(a.jsx)(w.c,{fill:!0,min:0,minorStepSize:null,onValueChange:f("noiseRadius"),stepSize:.1,value:l})}),Object(a.jsx)(w.a,{className:"PlanetForm-noiseMin",label:"Minimum Noise",children:Object(a.jsx)(w.d,{labelStepSize:.5,max:1,min:-1,onChange:f("noiseMin"),stepSize:.1,value:s})}),Object(a.jsx)(w.a,{className:"PlanetForm-elevationOffset",label:"Elevation Offset",children:Object(a.jsx)(w.d,{labelStepSize:.25,max:1,min:0,onChange:f("elevationOffset"),stepSize:.01,value:c})}),Object(a.jsx)(w.a,{className:"PlanetForm-elevationScale",label:"Elevation Scale",children:Object(a.jsx)(w.c,{fill:!0,min:0,minorStepSize:null,onValueChange:f("elevationScale"),stepSize:.1,value:o})})]})};var T=function(e){var n=e.children,t=function(e,n){var t=Object(i.useState)(e),a=Object(b.a)(t,2),c=a[0],o=a[1],r=Object(i.useState)(e),s=Object(b.a)(r,2),l=s[0],u=s[1];return Object(i.useEffect)((function(){var e=setTimeout((function(){u(c)}),n);return function(){clearTimeout(e)}}),[c,n]),[l,c,o]}(l.planet,400),c=Object(b.a)(t,3),o=c[0],r=c[1],s=c[2];return Object(a.jsxs)(u.Provider,{value:{planet:o},children:[n,Object(a.jsx)("div",{className:"Settings",children:Object(a.jsx)(R,{onUpdate:s,settings:r})})]})},E=function(){var e=j();return Object(a.jsxs)(s.a,{className:"Scene",children:[Object(a.jsx)("ambientLight",{}),Object(a.jsxs)(z,{children:[Object(a.jsx)("pointLight",{position:[16,16,16]}),Object(a.jsx)(u.Provider,{value:e,children:Object(a.jsx)(F,{})})]})]})},L=function(){return Object(a.jsx)(T,{children:Object(a.jsx)(E,{})})},V=function(e){e&&e instanceof Function&&t.e(3).then(t.bind(null,179)).then((function(n){var t=n.getCLS,a=n.getFID,i=n.getFCP,c=n.getLCP,o=n.getTTFB;t(e),a(e),i(e),c(e),o(e)}))};r.a.render(Object(a.jsx)(c.a.StrictMode,{children:Object(a.jsx)(L,{})}),document.getElementById("root")),V()}},[[174,1,2]]]);
//# sourceMappingURL=main.cac588b9.chunk.js.map