(this.webpackJsonpplanets=this.webpackJsonpplanets||[]).push([[0],{131:function(e,n,t){},143:function(e,n){},176:function(e,n,t){"use strict";t.r(n);var i=t(4),a=t(0),o=t.n(a),c=t(15),s=t.n(c),r=(t(131),t(20)),l=t(10),u=t(72),j=t(62),b=t.n(j),f=t(63),O=t.n(f),d=t(64),g=t.n(d),m=t(2),p=function(e){var n=Object(l.a)(e,2),t=n[0],i=n[1];return[m.MathUtils.radToDeg(i),90-m.MathUtils.radToDeg(t)]},h=function(e){var n=Object(l.a)(e,2),t=n[0],i=n[1];return[m.MathUtils.degToRad(90-i),m.MathUtils.degToRad(t)]},v=function(e){var n=Object(l.a)(e,2),t=n[0],i=n[1];return[Math.PI-Math.acos(2*i-1),2*Math.PI*t-Math.PI]},x=t(5),S=t(17),M=function(e){var n=e.center,t=e.color,o=e.elevationOffset,c=e.elevationScale,s=e.noiseMin,l=e.polygon,u=e.radius,j=Object(S.a)(e,["center","color","elevationOffset","elevationScale","noiseMin","polygon","radius"]),b=Object(a.useMemo)((function(){return l.map((function(e){return e.noise}))}),[l]),f=Object(a.useMemo)((function(){return l.map((function(e){return e.position}))}),[l]),O=Object(a.useCallback)((function(e,n){var t=u+Math.max(s,n)*c;return e.setLength(t),t}),[c,s,u]),d=Object(a.useCallback)((function(e){return n.noise*o+e*(1-o)}),[n.noise,o]),g=Object(a.useCallback)((function(e){var t=O(e.center,n.noise);if(n.noise<=s)for(var i=0;i<e.polygon.length;i++)e.polygon[i].setLength(t);else for(var a=0;a<e.polygon.length;a++){var o=d(b[a]);O(e.polygon[a],o)}}),[O,n.noise,d,b,s]),m=Object(a.useCallback)((function(e){e.origin.set(0,0,0),e.center.copy(n.position);for(var t=0;t<e.polygon.length;t++)e.polygon[t].copy(f[t])}),[n.position,f]),p=Object(r.e)((function(e){var n=function(e){return{center:e[e.length-1],origin:e[0],polygon:e.slice(1,e.length-1)}}(e.geometry.vertices);m(n),g(n)}),[g,m]);return Object(i.jsxs)("mesh",Object(x.a)(Object(x.a)({name:"PlanetTile"},j),{},{ref:p,children:[Object(i.jsx)("meshStandardMaterial",{color:t}),Object(i.jsx)("coneGeometry",{args:[1,1,l.length]})]}))},C=function(e){var n=e.settings,t=Object(a.useState)([]),o=Object(l.a)(t,2),c=o[0],s=o[1],r=Object(a.useMemo)((function(){return new b.a({shape:[1,1],minDistance:n.minDistance,tries:n.tries},O()(n.seed))}),[n.minDistance,n.seed,n.tries]),j=Object(a.useMemo)((function(){return new g.a(n.seed)}),[n.seed]),f=Object(a.useCallback)((function(e){var t=e.clone().setLength(n.noiseRadius),i=t.x,a=t.y,o=t.z;return j.noise3D(i,a,o)}),[n.noiseRadius,j]),d=Object(a.useCallback)((function(e){var n=Object(l.a)(e,2),t=n[0],i=n[1],a=new m.Vector3;return a.setFromSphericalCoords(1,t,i),{noise:f(a),position:a}}),[f]);Object(a.useEffect)((function(){var e=r.fill().map(v),t=e.map(p),i=Object(u.a)(t),a=i.centers.map(h).map(d),o=i.polygons.map((function(t,i){var o,c=d(e[i]);return{center:c,color:null===(o=n.biomes.find((function(e){return c.noise<=e.noiseMax})))||void 0===o?void 0:o.color,polygon:t.map((function(e){return a[e]}))}}));s(o)}),[r,n.biomes,d]);var x=Date.now().toString();return Object(i.jsx)("group",{name:"Planet",children:c.map((function(e,t){return Object(i.jsx)(M,{center:e.center,color:e.color,elevationOffset:n.elevationOffset,elevationScale:n.elevationScale,noiseMin:n.noiseMin,polygon:e.polygon,radius:n.radius},"".concat(x,"-").concat(t))}))})},y=t(68),D=Object(a.createContext)(null);Object(r.b)({OrbitControls:y.a});var N=function(e){var n=e.children,t=Object(S.a)(e,["children"]),o=Object(a.useRef)(),c=Object(r.d)(),s=c.camera,l=c.gl;return Object(r.c)((function(){o&&o.current&&o.current.update()})),Object(a.useEffect)((function(){s.position.set(0,0,16)}),[s.position]),Object(i.jsxs)(D.Provider,{value:t,children:[Object(i.jsx)("orbitControls",{args:[s,l.domElement],ref:o}),n]})},z={planet:{biomes:[{color:"steelblue",noiseMax:0},{color:"lemonchiffon",noiseMax:1/6},{color:"yellowgreen",noiseMax:2/6},{color:"forestgreen",noiseMax:.5},{color:"burlywood",noiseMax:4/6},{color:"darkgrey",noiseMax:5/6},{color:"snow",noiseMax:1}],elevationOffset:.5,elevationScale:1,noiseMin:0,noiseRadius:1,minDistance:.04,position:[0,0,0],radius:8,seed:Date.now().toString(),tries:8}},R=Object(a.createContext)(z),w=function(){return Object(a.useContext)(R)},k=t(7),P=t(180),T=function(e){var n,t=e.children,o=Object(a.useState)(z.planet),c=Object(l.a)(o,2),s=c[0],r=c[1],u=function(e){return function(n){return r((function(t){return Object(x.a)(Object(x.a)({},t),{},Object(k.a)({},e,n))}))}};return Object(i.jsxs)(R.Provider,{value:{planet:s},children:[t,Object(i.jsxs)("form",{className:"Settings",children:[Object(i.jsx)(P.a,{className:"Settings-seed",label:"Seed",children:Object(i.jsx)(P.b,{defaultValue:s.seed,fill:!0,onChange:(n="seed",function(e){var t=e.currentTarget.value;return r((function(e){return Object(x.a)(Object(x.a)({},e),{},Object(k.a)({},n,t))}))})})}),Object(i.jsx)(P.a,{className:"Settings-radius",label:"Radius",children:Object(i.jsx)(P.c,{fill:!0,min:0,onValueChange:u("radius"),value:s.radius})}),Object(i.jsx)(P.a,{className:"Settings-minDistance",label:"Sampling Minimum Distance",children:Object(i.jsx)(P.c,{fill:!0,min:.01,minorStepSize:null,onValueChange:u("minDistance"),stepSize:.01,value:s.minDistance})}),Object(i.jsx)(P.a,{className:"Settings-tries",label:"Sampling tries",children:Object(i.jsx)(P.c,{fill:!0,min:2,minorStepSize:null,onValueChange:u("tries"),value:s.tries})}),Object(i.jsx)(P.a,{className:"Settings-noiseRadius",label:"Noise Radius",children:Object(i.jsx)(P.c,{fill:!0,min:0,minorStepSize:null,onValueChange:u("noiseRadius"),stepSize:.1,value:s.noiseRadius})}),Object(i.jsx)(P.a,{className:"Settings-noiseMin",label:"Minimum Noise",children:Object(i.jsx)(P.d,{labelStepSize:.5,max:1,min:-1,onChange:u("noiseMin"),stepSize:.1,value:s.noiseMin})}),Object(i.jsx)(P.a,{className:"Settings-elevationOffset",label:"Elevation Offset",children:Object(i.jsx)(P.d,{labelStepSize:.25,max:1,min:0,onChange:u("elevationOffset"),stepSize:.01,value:s.elevationOffset})}),Object(i.jsx)(P.a,{className:"Settings-elevationScale",label:"Elevation Scale",children:Object(i.jsx)(P.c,{fill:!0,min:0,minorStepSize:null,onValueChange:u("elevationScale"),value:s.elevationScale})})]})]})},L=function(){var e=w();return Object(i.jsxs)(r.a,{className:"Scene",children:[Object(i.jsx)("ambientLight",{}),Object(i.jsxs)(N,{children:[Object(i.jsx)("pointLight",{position:[16,16,16]}),Object(i.jsx)(C,{settings:e.planet})]})]})},V=function(){return Object(i.jsx)(T,{children:Object(i.jsx)(L,{})})},E=function(e){e&&e instanceof Function&&t.e(3).then(t.bind(null,181)).then((function(n){var t=n.getCLS,i=n.getFID,a=n.getFCP,o=n.getLCP,c=n.getTTFB;t(e),i(e),a(e),o(e),c(e)}))};s.a.render(Object(i.jsx)(o.a.StrictMode,{children:Object(i.jsx)(V,{})}),document.getElementById("root")),E()}},[[176,1,2]]]);
//# sourceMappingURL=main.0a6d30c9.chunk.js.map