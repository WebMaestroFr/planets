(this.webpackJsonpplanets=this.webpackJsonpplanets||[]).push([[0],{130:function(e,n,t){},142:function(e,n){},174:function(e,n,t){"use strict";t.r(n);var a=t(4),c=t(0),i=t.n(c),o=t(16),r=t.n(o),s=(t(130),t(19)),l=t(9),u=t(71),j=t(61),b=t.n(j),O=t(62),f=t.n(O),m=t(63),d=t.n(m),p=t(2),v=function(e){var n=Object(l.a)(e,2),t=n[0],a=n[1];return[p.MathUtils.radToDeg(a),90-p.MathUtils.radToDeg(t)]},g=function(e){var n=Object(l.a)(e,2),t=n[0],a=n[1];return[p.MathUtils.degToRad(90-a),p.MathUtils.degToRad(t)]},h=function(e){var n=Object(l.a)(e,2),t=n[0],a=n[1];return[Math.PI-Math.acos(2*a-1),2*Math.PI*t-Math.PI]};var x=t(5),S=t(17),M=function(e){var n=e.center,t=e.polygon,i=Object(S.a)(e,["center","polygon"]),o=y(),r=o.biomes,l=o.elevationOffset,u=o.elevationScale,j=o.noiseMin,b=o.radius,O=Object(c.useMemo)((function(){return r.find((function(e){return n.noise<=e.noiseMax}))}),[r,n.noise]),f=Object(c.useMemo)((function(){return t.map((function(e){return e.noise}))}),[t]),m=Object(c.useMemo)((function(){return t.map((function(e){return e.position}))}),[t]),d=Object(c.useCallback)((function(e,n){var t=b+Math.max(j,n)*u;return e.setLength(t),t}),[u,j,b]),p=Object(c.useCallback)((function(e){return n.noise*l+e*(1-l)}),[n.noise,l]),v=Object(c.useCallback)((function(e){var t=d(e.center,n.noise);if(n.noise<=j)for(var a=0;a<e.polygon.length;a++)e.polygon[a].setLength(t);else for(var c=0;c<e.polygon.length;c++){var i=p(f[c]);d(e.polygon[c],i)}}),[d,n.noise,p,f,j]),g=Object(c.useCallback)((function(e){e.origin.set(0,0,0),e.center.copy(n.position);for(var t=0;t<e.polygon.length;t++)e.polygon[t].copy(m[t])}),[n.position,m]),h=Object(s.e)((function(e){var n,t=e.geometry,a={center:(n=t.vertices)[n.length-1],origin:n[0],polygon:n.slice(1,n.length-1)};g(a),v(a)}),[v,g]);return Object(a.jsxs)("mesh",Object(x.a)(Object(x.a)({name:"PlanetTile"},i),{},{ref:h,children:[Object(a.jsx)("coneGeometry",{args:[1,1,t.length]}),Object(a.jsx)("meshLambertMaterial",{color:null===O||void 0===O?void 0:O.color})]}))},C=Object(c.createContext)({}),y=function(){return Object(c.useContext)(C)},P=function(e){var n=e.settings,t=Object(c.useRef)(),i=function(e){var n=e.minDistance,t=e.noiseRadius,a=e.seed,i=e.tries,o=Object(c.useState)([]),r=Object(l.a)(o,2),s=r[0],j=r[1],O=Object(c.useMemo)((function(){return new b.a({shape:[1,1],minDistance:n,tries:i},f()(a))}),[n,a,i]),m=Object(c.useMemo)((function(){return new d.a(a)}),[a]),x=Object(c.useCallback)((function(e){var n=e.clone().setLength(t),a=n.x,c=n.y,i=n.z;return m.noise3D(a,c,i)}),[t,m]),S=Object(c.useCallback)((function(e){var n=Object(l.a)(e,2),t=n[0],a=n[1],c=new p.Vector3;return c.setFromSphericalCoords(1,t,a),{noise:x(c),position:c}}),[x]);return Object(c.useEffect)((function(){var e=O.fill().map(h),n=e.map(v),t=Object(u.a)(n),a=t.centers.map(g).map(S),c=Date.now().toString(),i=t.polygons.map((function(n,t){return{center:S(e[t]),key:"".concat(c,"-").concat(t),polygon:n.map((function(e){return a[e]}))}}));j(i)}),[O,S]),s}(n);return Object(s.c)((function(){t&&t.current&&(t.current.rotation.y+=.005)})),Object(a.jsx)("group",{name:"Planet",ref:t,children:Object(a.jsx)(C.Provider,{value:n,children:i.map((function(e){return Object(a.jsx)(M,{center:e.center,polygon:e.polygon},e.key)}))})})},F=t(67),k=Object(c.createContext)(null);Object(s.b)({OrbitControls:F.a});var D=function(e){var n=e.children,t=Object(S.a)(e,["children"]),i=Object(c.useRef)(),o=Object(s.d)(),r=o.camera,l=o.gl;return Object(s.c)((function(){i&&i.current&&i.current.update()})),Object(a.jsxs)(k.Provider,{value:t,children:[Object(a.jsx)("orbitControls",{args:[r,l.domElement],ref:i}),n]})},N={planet:{biomes:[{color:"steelblue",noiseMax:0},{color:"lemonchiffon",noiseMax:1/6},{color:"yellowgreen",noiseMax:2/6},{color:"forestgreen",noiseMax:.5},{color:"burlywood",noiseMax:4/6},{color:"darkgrey",noiseMax:5/6},{color:"snow",noiseMax:1}],elevationOffset:.5,elevationScale:1,noiseMin:0,noiseRadius:1,minDistance:.04,position:[0,0,0],radius:8,seed:Date.now().toString(),tries:8}},z=Object(c.createContext)(N),R=function(){return Object(c.useContext)(z)},w=t(7),T=t(178),E=function(e){var n=e.onUpdate,t=e.settings,i=t.elevationOffset,o=t.elevationScale,r=t.minDistance,s=t.noiseMin,l=t.noiseRadius,u=t.radius,j=t.seed,b=t.tries,O=Object(c.useCallback)((function(e){return function(t){var a=t.currentTarget.value;return n((function(n){return Object(x.a)(Object(x.a)({},n),{},Object(w.a)({},e,a))}))}}),[n]),f=Object(c.useCallback)((function(e){return function(t){return n((function(n){return Object(x.a)(Object(x.a)({},n),{},Object(w.a)({},e,t))}))}}),[n]);return Object(a.jsxs)("form",{className:"PlanetForm",children:[Object(a.jsx)(T.a,{className:"PlanetForm-seed",label:"Seed",children:Object(a.jsx)(T.b,{defaultValue:j,fill:!0,onChange:O("seed")})}),Object(a.jsx)(T.a,{className:"PlanetForm-radius",label:"Radius",children:Object(a.jsx)(T.c,{fill:!0,min:0,onValueChange:f("radius"),value:u})}),Object(a.jsx)(T.a,{className:"PlanetForm-minDistance",label:"Sampling Minimum Distance",children:Object(a.jsx)(T.c,{fill:!0,min:.01,minorStepSize:null,onValueChange:f("minDistance"),stepSize:.01,value:r})}),Object(a.jsx)(T.a,{className:"PlanetForm-tries",label:"Sampling tries",children:Object(a.jsx)(T.c,{fill:!0,min:2,minorStepSize:null,onValueChange:f("tries"),value:b})}),Object(a.jsx)(T.a,{className:"PlanetForm-noiseRadius",label:"Noise Radius",children:Object(a.jsx)(T.c,{fill:!0,min:0,minorStepSize:null,onValueChange:f("noiseRadius"),stepSize:.1,value:l})}),Object(a.jsx)(T.a,{className:"PlanetForm-noiseMin",label:"Minimum Noise",children:Object(a.jsx)(T.d,{labelStepSize:.5,max:1,min:-1,onChange:f("noiseMin"),stepSize:.1,value:s})}),Object(a.jsx)(T.a,{className:"PlanetForm-elevationOffset",label:"Elevation Offset",children:Object(a.jsx)(T.d,{labelStepSize:.25,max:1,min:0,onChange:f("elevationOffset"),stepSize:.01,value:i})}),Object(a.jsx)(T.a,{className:"PlanetForm-elevationScale",label:"Elevation Scale",children:Object(a.jsx)(T.c,{fill:!0,min:0,minorStepSize:null,onValueChange:f("elevationScale"),stepSize:.1,value:o})})]})};var L=function(e){var n=e.children,t=Object(S.a)(e,["children"]),i=function(e,n){var t=Object(c.useState)(e),a=Object(l.a)(t,2),i=a[0],o=a[1],r=Object(c.useState)(e),s=Object(l.a)(r,2),u=s[0],j=s[1];return Object(c.useEffect)((function(){var e=setTimeout((function(){j(i)}),n);return function(){clearTimeout(e)}}),[i,n]),[u,i,o]}(N.planet,400),o=Object(l.a)(i,3),r=o[0],s=o[1],u=o[2];return Object(a.jsxs)(z.Provider,Object(x.a)(Object(x.a)({value:{planet:r}},t),{},{children:[n,Object(a.jsx)("div",{className:"Settings",children:Object(a.jsx)(E,{onUpdate:u,settings:s})})]}))},V=function(){var e=R(),n=Object(s.d)().camera;return Object(c.useEffect)((function(){n.position.set(0,0,2*-e.planet.radius)}),[n.position,e.planet.radius]),Object(a.jsxs)(D,{children:[Object(a.jsx)("pointLight",{position:[-e.planet.radius,-e.planet.radius,-e.planet.radius]}),Object(a.jsx)(P,{settings:e.planet})]})},U=function(){var e=R();return Object(a.jsx)(s.a,{className:"AppCanvas",children:Object(a.jsx)(z.Provider,{value:e,children:Object(a.jsx)(V,{})})})},I=function(){return Object(a.jsx)(L,{children:Object(a.jsx)(U,{})})},B=function(e){e&&e instanceof Function&&t.e(3).then(t.bind(null,179)).then((function(n){var t=n.getCLS,a=n.getFID,c=n.getFCP,i=n.getLCP,o=n.getTTFB;t(e),a(e),c(e),i(e),o(e)}))};r.a.render(Object(a.jsx)(i.a.StrictMode,{children:Object(a.jsx)(I,{})}),document.getElementById("root")),B()}},[[174,1,2]]]);
//# sourceMappingURL=main.d26560c7.chunk.js.map